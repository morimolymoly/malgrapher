import unittest
import subprocess


class TestCreateBreakpoints(unittest.TestCase):
    """test methods for create_breakpoints.py
    """

    def setUp(self):
        self.target_file_path = 'target/test32'

    def test_get_offset(self):
        """test method for create_breakpoints
        """

        target_tested_file = './gdb_scripts/create_breakpoints.py'
        target_test_file = './target/test32'

        init_args = ['rm', '-f', 'offset']
        subprocess.call(init_args)

        gdb_args = ['gdb', '-q', '-x', target_tested_file, target_test_file]
        subprocess.call(gdb_args)

        breakpoints = []
        with open('breakpoints', 'r') as f:
            breakpoints = f.read()
        breakpoints = breakpoints.split('\n')[:-1]

        got = breakpoints
        want = ["0x56555378", "0x56555379", "0x5655537c", "0x56555381", "0x56555387", "0x5655538d",
                "0x5655538f",
                "0x56555391",
                "0x56555396",
                "0x56555399",
                "0x5655539a",
                "0x565553b0",
                "0x565553b6",
                "0x565553bb",
                "0x565553c0",
                "0x565553c6",
                "0x565553cb",
                "0x565553d0",
                "0x565553d6",
                "0x565553d8",
                "0x565553de",
                "0x565553e0",
                "0x565553e2",
                "0x565553e3",
                "0x565553e5",
                "0x565553e8",
                "0x565553e9",
                "0x565553ea",
                "0x565553eb",
                "0x565553f0",
                "0x565553f6",
                "0x565553fc",
                "0x565553fd",
                "0x56555403",
                "0x56555404",
                "0x56555405",
                "0x56555406",
                "0x5655540c",
                "0x56555411",
                "0x56555412",
                "0x56555415",
                "0x56555416",
                "0x56555418",
                "0x5655541a",
                "0x5655541c",
                "0x5655541e",
                "0x56555420",
                "0x56555423",
                "0x56555430",
                "0x56555435",
                "0x5655543b",
                "0x56555441",
                "0x56555447",
                "0x56555449",
                "0x5655544b",
                "0x56555451",
                "0x56555453",
                "0x56555455",
                "0x56555456",
                "0x56555458",
                "0x5655545b",
                "0x5655545c",
                "0x5655545e",
                "0x56555461",
                "0x56555462",
                "0x56555463",
                "0x56555464",
                "0x56555468",
                "0x5655546a",
                "0x56555470",
                "0x56555475",
                "0x5655547b",
                "0x5655547c",
                "0x56555482",
                "0x56555488",
                "0x5655548a",
                "0x5655548c",
                "0x5655548d",
                "0x56555490",
                "0x56555492",
                "0x56555495",
                "0x56555498",
                "0x5655549a",
                "0x5655549c",
                "0x5655549e",
                "0x565554a4",
                "0x565554a6",
                "0x565554a8",
                "0x565554ab",
                "0x565554ac",
                "0x565554ad",
                "0x565554af",
                "0x565554b2",
                "0x565554b5",
                "0x565554b6",
                "0x565554b7",
                "0x565554b9",
                "0x565554c0",
                "0x565554c1",
                "0x565554c3",
                "0x565554c4",
                "0x565554c9",
                "0x565554cf",
                "0x565554d2",
                "0x565554d9",
                "0x565554db",
                "0x565554e1",
                "0x565554e3",
                "0x565554e5",
                "0x565554e8",
                "0x565554ee",
                "0x565554f3",
                "0x565554f6",
                "0x565554fb",
                "0x56555502",
                "0x56555505",
                "0x56555506",
                "0x56555507",
                "0x56555509",
                "0x56555510",
                "0x56555511",
                "0x56555513",
                "0x56555514",
                "0x56555519",
                "0x5655551c",
                "0x5655551d",
                "0x56555521",
                "0x56555524",
                "0x56555527",
                "0x56555528",
                "0x5655552a",
                "0x5655552b",
                "0x5655552c",
                "0x5655552f",
                "0x56555534",
                "0x5655553a",
                "0x56555541",
                "0x56555548",
                "0x5655554c",
                "0x5655554e",
                "0x56555551",
                "0x56555557",
                "0x56555558",
                "0x5655555d",
                "0x56555560",
                "0x56555564",
                "0x56555566",
                "0x56555569",
                "0x5655556f",
                "0x56555570",
                "0x56555575",
                "0x56555578",
                "0x5655557a",
                "0x5655557d",
                "0x56555583",
                "0x56555584",
                "0x56555589",
                "0x5655558c",
                "0x5655558e",
                "0x56555591",
                "0x56555597",
                "0x56555598",
                "0x5655559d",
                "0x565555a0",
                "0x565555a4",
                "0x565555a6",
                "0x565555a9",
                "0x565555af",
                "0x565555b0",
                "0x565555b5",
                "0x565555b8",
                "0x565555ba",
                "0x565555bd",
                "0x565555c3",
                "0x565555c4",
                "0x565555c9",
                "0x565555cc",
                "0x565555d1",
                "0x565555d4",
                "0x565555d5",
                "0x565555d6",
                "0x565555d7",
                "0x565555da",
                "0x565555e0",
                "0x565555e1",
                "0x565555e2",
                "0x565555e3",
                "0x565555e4",
                "0x565555e9",
                "0x565555ef",
                "0x565555f2",
                "0x565555f6",
                "0x565555fc",
                "0x56555601",
                "0x56555607",
                "0x56555609",
                "0x5655560c",
                "0x5655560e",
                "0x56555610",
                "0x56555612",
                "0x56555618",
                "0x5655561b",
                "0x5655561c",
                "0x56555620",
                "0x56555624",
                "0x5655562b",
                "0x5655562e",
                "0x56555631",
                "0x56555633",
                "0x56555635",
                "0x56555638",
                "0x56555639",
                "0x5655563a",
                "0x5655563b",
                "0x5655563c",
                "0x56555640",
                "0x56555644",
                "0x56555645",
                "0x56555648",
                "0x5655564d",
                "0x56555653",
                "0x56555656",
                "0x56555657",
                ]
        self.assertCountEqual(want, got)
        self.assertListEqual(want, got)
